{
	"info": {
		"_postman_id": "cpe-consultas-v2-collection",
		"name": "API SUNAT - Consultas CPE v2 (Mejorado)",
		"description": "Colección especializada para consultas de Comprobantes de Pago Electrónicos (CPE) con sistema dual: OAuth2 + SOAP fallback. Incluye descarga de CDRs, validación de documentos y consultas masivas.\n\n## 🚀 Características:\n- Sistema de fallback automático (OAuth2 → SOAP)\n- Descarga y gestión de CDRs\n- Consulta por datos directos\n- Consultas masivas con filtros\n- Validación previa de documentos\n\n## 🔧 Configuración:\n1. Configurar variables: base_url, access_token, company_id\n2. Ejecutar autenticación\n3. Seleccionar empresa\n4. Realizar consultas CPE",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "api-sunat-cpe-v2"
	},
	"item": [
		{
			"name": "🔐 1. AUTENTICACIÓN",
			"item": [
				{
					"name": "1.1 - Login y Obtener Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data.access_token) {",
									"        pm.collectionVariables.set('access_token', response.data.access_token);",
									"        pm.collectionVariables.set('user_id', response.data.user.id);",
									"        console.log('✅ Token guardado correctamente');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"admin@test.com\",\n    \"password\": \"password\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": ["{{base_url}}"],
							"path": ["auth", "login"]
						}
					},
					"response": []
				},
				{
					"name": "1.2 - Verificar Token Actual",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    console.log('✅ Token válido para usuario:', response.user.name);",
									"} else {",
									"    console.log('❌ Token inválido, renovar autenticación');",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/me",
							"host": ["{{base_url}}"],
							"path": ["auth", "me"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "🏢 2. SELECCIÓN DE EMPRESA",
			"item": [
				{
					"name": "2.1 - Listar Empresas Disponibles",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data.length > 0) {",
									"        // Guardar primera empresa por defecto",
									"        const firstCompany = response.data[0];",
									"        pm.collectionVariables.set('company_id', firstCompany.id);",
									"        pm.collectionVariables.set('company_ruc', firstCompany.ruc);",
									"        pm.collectionVariables.set('company_name', firstCompany.razon_social);",
									"        console.log('✅ Empresa seleccionada:', firstCompany.razon_social, '- RUC:', firstCompany.ruc);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/companies",
							"host": ["{{base_url}}"],
							"path": ["v1", "companies"]
						}
					},
					"response": []
				},
				{
					"name": "2.2 - Ver Detalles de Empresa Seleccionada",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        const company = response.data;",
									"        console.log('🏢 Empresa:', company.razon_social);",
									"        console.log('📋 RUC:', company.ruc);",
									"        console.log('🌍 Modo:', company.modo_produccion ? 'Producción' : 'Beta');",
									"        console.log('⚙️ Credenciales OAuth2:', company.gre_client_id_produccion ? '✅' : '❌');",
									"        console.log('🔐 Credenciales SOL:', company.usuario_sol ? '✅' : '❌');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/companies/{{company_id}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "companies", "{{company_id}}"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "📄 3. CONSULTAS INDIVIDUALES CPE",
			"item": [
				{
					"name": "3.1 - Consultar Factura (Método Mejorado)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta exitosa');",
									"        console.log('📄 Comprobante:', response.data.comprobante.serie + '-' + response.data.comprobante.correlativo);",
									"        console.log('🔧 Método usado:', response.data.metodo_usado);",
									"        console.log('📊 Estado:', response.data.consulta.codigo || response.data.consulta.estadocpe);",
									"        if (response.data.consulta.mensaje) {",
									"            console.log('💬 Mensaje:', response.data.consulta.mensaje);",
									"        }",
									"    } else {",
									"        console.log('❌ Error:', response.message);",
									"    }",
									"} else {",
									"    console.log('❌ Error HTTP:', pm.response.code);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/factura/{{invoice_id}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "factura", "{{invoice_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "3.2 - Consultar Factura con Descarga de CDR",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta con CDR exitosa');",
									"        console.log('📄 Comprobante:', response.data.comprobante.serie + '-' + response.data.comprobante.correlativo);",
									"        console.log('🔧 Método usado:', response.data.metodo_usado);",
									"        if (response.data.cdr_guardado) {",
									"            console.log('📦 CDR guardado:', response.data.cdr_guardado);",
									"            pm.collectionVariables.set('cdr_filename', response.data.cdr_guardado);",
									"        }",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/factura/{{invoice_id}}/con-cdr",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "factura", "{{invoice_id}}", "con-cdr"]
						}
					},
					"response": []
				},
				{
					"name": "3.3 - Consultar Boleta (Método Mejorado)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta boleta exitosa');",
									"        console.log('📄 Comprobante:', response.data.comprobante.serie + '-' + response.data.comprobante.correlativo);",
									"        console.log('🔧 Método usado:', response.data.metodo_usado);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/boleta/{{boleta_id}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "boleta", "{{boleta_id}}"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "🎯 4. CONSULTA POR DATOS DIRECTOS",
			"item": [
				{
					"name": "4.1 - Consultar por Datos (Sin CDR)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta por datos exitosa');",
									"        console.log('🔧 Método usado:', response.data.metodo_usado);",
									"        console.log('📊 Resultado:', JSON.stringify(response.data.consulta, null, 2));",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"ruc_emisor\": \"{{company_ruc}}\",\n    \"tipo_documento\": \"01\",\n    \"serie\": \"F001\",\n    \"correlativo\": 1,\n    \"fecha_emision\": \"2024-01-15\",\n    \"monto_total\": 118.00,\n    \"incluir_cdr\": false\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/por-datos",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "por-datos"]
						}
					},
					"response": []
				},
				{
					"name": "4.2 - Consultar por Datos (Con CDR)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta por datos con CDR exitosa');",
									"        console.log('🔧 Método usado:', response.data.metodo_usado);",
									"        if (response.data.cdr_guardado) {",
									"            console.log('📦 CDR guardado:', response.data.cdr_guardado);",
									"            pm.collectionVariables.set('cdr_filename', response.data.cdr_guardado);",
									"        }",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"ruc_emisor\": \"{{company_ruc}}\",\n    \"tipo_documento\": \"03\",\n    \"serie\": \"B001\",\n    \"correlativo\": 1,\n    \"fecha_emision\": \"2024-01-15\",\n    \"monto_total\": 59.00,\n    \"incluir_cdr\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/por-datos",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "por-datos"]
						}
					},
					"response": []
				},
				{
					"name": "4.3 - Consultar Nota de Crédito por Datos",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta nota crédito exitosa');",
									"        console.log('🔧 Método usado:', response.data.metodo_usado);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"ruc_emisor\": \"{{company_ruc}}\",\n    \"tipo_documento\": \"07\",\n    \"serie\": \"FC01\",\n    \"correlativo\": 1,\n    \"fecha_emision\": \"2024-01-15\",\n    \"monto_total\": 25.00,\n    \"incluir_cdr\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/por-datos",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "por-datos"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "🚀 5. CONSULTAS MASIVAS",
			"item": [
				{
					"name": "5.1 - Consulta Masiva (Todos los Pendientes)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta masiva completada');",
									"        console.log('📊 Total procesados:', response.data.total_procesados);",
									"        console.log('✅ Exitosos:', response.data.exitosos);",
									"        console.log('❌ Fallidos:', response.data.fallidos);",
									"        ",
									"        // Mostrar algunos resultados",
									"        if (response.data.resultados.length > 0) {",
									"            console.log('📋 Primeros resultados:');",
									"            response.data.resultados.slice(0, 3).forEach((resultado, index) => {",
									"                console.log(`${index + 1}. ${resultado.serie_correlativo} - ${resultado.resultado.success ? '✅' : '❌'}`);",
									"            });",
									"        }",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"limite\": 20\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/masivo",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "masivo"]
						}
					},
					"response": []
				},
				{
					"name": "5.2 - Consulta Masiva (Solo Facturas)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta masiva facturas completada');",
									"        console.log('📊 Estadísticas:', {",
									"            'Total procesados': response.data.total_procesados,",
									"            'Exitosos': response.data.exitosos,",
									"            'Fallidos': response.data.fallidos",
									"        });",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"tipo_documento\": [\"01\"],\n    \"limite\": 30\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/masivo",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "masivo"]
						}
					},
					"response": []
				},
				{
					"name": "5.3 - Consulta Masiva (Por Rango de Fechas)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Consulta masiva por fechas completada');",
									"        const data = response.data;",
									"        console.log(`📊 Resultados: ${data.exitosos}/${data.total_procesados} exitosos`);",
									"        ",
									"        // Agrupar por método usado",
									"        const metodos = {};",
									"        data.resultados.forEach(r => {",
									"            const metodo = r.resultado.metodo || 'unknown';",
									"            metodos[metodo] = (metodos[metodo] || 0) + 1;",
									"        });",
									"        console.log('🔧 Métodos utilizados:', metodos);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"fecha_desde\": \"2024-01-01\",\n    \"fecha_hasta\": \"2024-01-31\",\n    \"tipo_documento\": [\"01\", \"03\"],\n    \"limite\": 50\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/masivo",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "masivo"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "✅ 6. VALIDACIÓN DE DOCUMENTOS",
			"item": [
				{
					"name": "6.1 - Validar Factura",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success) {",
									"        console.log('✅ Documento válido para consulta');",
									"        console.log('📄 Documento:', response.data.documento.serie + '-' + response.data.documento.correlativo);",
									"    } else {",
									"        console.log('❌ Documento con errores:');",
									"        response.data.errores.forEach(error => {",
									"            console.log('  - ' + error);",
									"        });",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/validar/factura/{{invoice_id}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "validar", "factura", "{{invoice_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "6.2 - Validar Boleta",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/validar/boleta/{{boleta_id}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "validar", "boleta", "{{boleta_id}}"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "📦 7. GESTIÓN DE CDRs",
			"item": [
				{
					"name": "7.1 - Listar CDRs Guardados",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    if (response.success && response.data.length > 0) {",
									"        console.log('📦 CDRs encontrados:', response.data.length);",
									"        response.data.forEach((cdr, index) => {",
									"            console.log(`${index + 1}. ${cdr.filename} (${(cdr.size / 1024).toFixed(1)} KB) - ${cdr.fecha_creacion}`);",
									"        });",
									"        ",
									"        // Guardar primer CDR para descarga",
									"        if (response.data.length > 0) {",
									"            pm.collectionVariables.set('cdr_filename', response.data[0].filename);",
									"        }",
									"    } else {",
									"        console.log('📦 No hay CDRs guardados');",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/cdr/{{company_id}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "cdr", "{{company_id}}"]
						}
					},
					"response": []
				},
				{
					"name": "7.2 - Descargar CDR Específico",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    console.log('✅ CDR descargado correctamente');",
									"    console.log('📁 Tamaño:', pm.response.headers.get('Content-Length') + ' bytes');",
									"} else {",
									"    console.log('❌ Error al descargar CDR');",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/cdr/{{company_id}}/{{cdr_filename}}",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "cdr", "{{company_id}}", "{{cdr_filename}}"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "🧪 8. PRUEBAS Y DEBUGGING",
			"item": [
				{
					"name": "8.1 - Test de Conectividad API",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('API responde correctamente', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Estructura de respuesta correcta', function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/health",
							"host": ["{{base_url}}"],
							"path": ["health"]
						}
					},
					"response": []
				},
				{
					"name": "8.2 - Test de Datos de Ejemplo",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    console.log('🧪 Test completado');",
									"    console.log('📊 Resultado:', response.success ? '✅ Exitoso' : '❌ Fallido');",
									"    if (!response.success) {",
									"        console.log('💬 Error:', response.message);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{access_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": {{company_id}},\n    \"ruc_emisor\": \"20000000001\",\n    \"tipo_documento\": \"01\",\n    \"serie\": \"F001\",\n    \"correlativo\": 1,\n    \"fecha_emision\": \"2024-01-15\",\n    \"monto_total\": 118.00,\n    \"incluir_cdr\": false\n}"
						},
						"url": {
							"raw": "{{base_url}}/v1/consulta-cpe-v2/por-datos",
							"host": ["{{base_url}}"],
							"path": ["v1", "consulta-cpe-v2", "por-datos"]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script global que se ejecuta antes de cada request",
					"console.log('🚀 Ejecutando request:', pm.info.requestName);"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Script global que se ejecuta después de cada response",
					"const responseTime = pm.response.responseTime;",
					"const statusCode = pm.response.code;",
					"console.log(`⏱️ Tiempo respuesta: ${responseTime}ms - Status: ${statusCode}`);"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000/api",
			"type": "string"
		},
		{
			"key": "access_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "company_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "company_ruc",
			"value": "",
			"type": "string"
		},
		{
			"key": "company_name",
			"value": "",
			"type": "string"
		},
		{
			"key": "user_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "invoice_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "boleta_id",
			"value": "1",
			"type": "string"
		},
		{
			"key": "cdr_filename",
			"value": "",
			"type": "string"
		}
	]
}